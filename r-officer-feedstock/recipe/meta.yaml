{% set version = '0.6.2' %}

{% set posix = 'm2-' if win else '' %}
{% set native = 'm2w64-' if win else '' %}

package:
  name: r-officer
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/officer_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/officer/officer_{{ version }}.tar.gz
  sha256: 0948b5785c90767b63382b17a36c5167c54c5ba6dc61c80e808e16df620bd335

build:
  merge_build_host: True  # [win]
  # If this is a new build for the same version, increment the build number.
  number: 0
  # no skip
  noarch: generic

  # This is required to make R link correctly on Linux.
  rpaths:
    - lib/R/lib/
    - lib/

# Suggests: testthat, devEMF, ggplot2, rmarkdown, doconv (>= 0.3.0), knitr, rsvg, magick
requirements:
  build:
    - {{ posix }}zip               # [win]

  host:
    - r-base
    - r-r6
    - r-openssl
    - r-ragg
    - r-uuid
    - r-xml2 >=1.1.0
    - r-zip >=2.1.0

  run:
    - r-base
    - r-r6
    - r-openssl
    - r-ragg
    - r-uuid
    - r-xml2 >=1.1.0
    - r-zip >=2.1.0

test:
  commands:
    # You can put additional test commands to be run here.
    - $R -e "library('officer')"           # [not win]
    - "\"%R%\" -e \"library('officer')\""  # [win]

  # You can also put a file called run_test.py, run_test.sh, or run_test.bat
  # in the recipe that will be run at test time.

  # requires:
    # Put any additional test requirements here.

about:
  home: https://ardata-fr.github.io/officeverse/, https://davidgohel.github.io/officer/
  license: MIT
  summary: Access and manipulate 'Microsoft Word', 'RTF' and 'Microsoft PowerPoint' documents
    from R. The package focuses on tabular and graphical reporting from R; it also provides
    two functions that let users get document content into data objects. A set of functions
    lets add and remove images, tables and paragraphs of text in new or existing documents.
    The package does not require any installation of Microsoft products to be able to
    write Microsoft files.
  license_family: MIT
  license_file:
    - '{{ environ["PREFIX"] }}/lib/R/share/licenses/MIT'
    - LICENSE

extra:
  recipe-maintainers:
    - katietz

# The original CRAN metadata for this package was:

# Package: officer
# Type: Package
# Title: Manipulation of Microsoft Word and PowerPoint Documents
# Version: 0.6.2
# Authors@R: c( person("David", "Gohel", role = c("aut", "cre"), email = "david.gohel@ardata.fr"), person(given = "ArData", role = "cph"), person("Frank", "Hangler", role = "ctb", email = "frank@plotandscatter.com", comment = "function body_replace_all_text"), person("Liz", "Sander", role = "ctb", email = 'lsander@civisanalytics.com', comment = "several documentation fixes"), person("Anton", "Victorson", role = "ctb", email = 'anton@victorson.se',comment = "fixes xml structures"), person("Jon", "Calder", role = "ctb", email = 'jonmcalder@gmail.com', comment = "update vignettes"), person("John", "Harrold", role = "ctb", email = 'john.m.harrold@gmail.com', comment = "function annotate_base"), person("John", "Muschelli", role = "ctb", email = 'muschellij2@gmail.com', comment = "google doc compatibility"), person("Bill", "Denney", email="wdenney@humanpredictions.com", role="ctb", comment=c(ORCID="0000-0002-5759-428X", "function as.matrix.rpptx")), person("Nikolai", "Beck", role = "ctb", email = 'beck.nikolai@gmail.com', comment = "set speaker notes for .pptx documents"), person("Stefan", "Moog", role = "ctb", email = 'moogs@gmx.de', comment = "added functionality to set shape geometry and outline"), person("Greg", "Leleu", role = "ctb", email = 'gregoire.leleu@gmail.com', comment = "fields functionality in ppt"), person("Hongyuan", "Jia", role = "ctb", email = "hongyuanjia@cqust.edu.cn", comment = c(ORCID = "0000-0002-0075-8183")) )
# Description: Access and manipulate 'Microsoft Word', 'RTF' and 'Microsoft PowerPoint' documents from R. The package focuses on tabular and graphical reporting from R; it also provides two functions that let users get document content into data objects. A set of functions lets add and remove images, tables and paragraphs of text in new or existing documents. The package does not require any installation of Microsoft products to be able to write Microsoft files.
# License: MIT + file LICENSE
# Imports: grDevices, stats, graphics, utils, zip (>= 2.1.0), xml2 (>= 1.1.0), openssl, R6, uuid, ragg
# URL: https://ardata-fr.github.io/officeverse/, https://davidgohel.github.io/officer/
# Encoding: UTF-8
# BugReports: https://github.com/davidgohel/officer/discussions
# RoxygenNote: 7.2.3
# Suggests: testthat, devEMF, ggplot2, rmarkdown, doconv (>= 0.3.0), knitr, rsvg, magick
# NeedsCompilation: no
# Packaged: 2023-03-28 19:52:56 UTC; davidgohel
# Author: David Gohel [aut, cre], ArData [cph], Frank Hangler [ctb] (function body_replace_all_text), Liz Sander [ctb] (several documentation fixes), Anton Victorson [ctb] (fixes xml structures), Jon Calder [ctb] (update vignettes), John Harrold [ctb] (function annotate_base), John Muschelli [ctb] (google doc compatibility), Bill Denney [ctb] (<https://orcid.org/0000-0002-5759-428X>, function as.matrix.rpptx), Nikolai Beck [ctb] (set speaker notes for .pptx documents), Stefan Moog [ctb] (added functionality to set shape geometry and outline), Greg Leleu [ctb] (fields functionality in ppt), Hongyuan Jia [ctb] (<https://orcid.org/0000-0002-0075-8183>)
# Maintainer: David Gohel <david.gohel@ardata.fr>
# Repository: CRAN
# Date/Publication: 2023-03-28 20:30:02 UTC

# See
# https://docs.conda.io/projects/conda-build for
# more information about meta.yaml
