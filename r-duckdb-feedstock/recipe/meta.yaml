{% set version = '0.9.1-1' %}

{% set posix = 'm2-' if win else '' %}
{% set native = 'm2w64-' if win else '' %}

package:
  name: r-duckdb
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/duckdb_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/duckdb/duckdb_{{ version }}.tar.gz
  sha256: 1e6970446253ff3a25e7d0038cdc632f25ee5d45de1d9e3fa4026f1c65141967

build:
  merge_build_host: True  # [win]
  # If this is a new build for the same version, increment the build number.
  number: 0
  # no skip

  # This is required to make R link correctly on Linux.
  rpaths:
    - lib/R/lib/
    - lib/

# Suggests: arrow (>= 13.0.0), bit64, callr, DBItest, dplyr, dbplyr, rlang, testthat, tibble, vctrs, withr, adbcdrivermanager
requirements:
  build:
    - {{ compiler('c') }}              # [not win]
    - {{ compiler('m2w64_c') }}        # [win]
    - {{ compiler('cxx') }}            # [not win]
    - {{ compiler('m2w64_cxx') }}      # [win]
    - {{ posix }}filesystem        # [win]
    - {{ posix }}sed               # [win]
    - {{ posix }}grep              # [win]
    - {{ posix }}autoconf
    - {{ posix }}automake          # [not win]
    - {{ posix }}automake-wrapper  # [win]
    - {{ posix }}pkg-config
    - {{ posix }}make
    - {{ posix }}coreutils         # [win]
    - {{ posix }}zip               # [win]

  host:
    - r-base
    - r-dbi

  run:
    - r-base
    - {{native}}gcc-libs         # [win]
    - r-dbi

test:
  commands:
    # You can put additional test commands to be run here.
    - $R -e "library('duckdb')"           # [not win]
    - "\"%R%\" -e \"library('duckdb')\""  # [win]

  # You can also put a file called run_test.py, run_test.sh, or run_test.bat
  # in the recipe that will be run at test time.

  # requires:
    # Put any additional test requirements here.

about:
  home: https://duckdb.org/, https://github.com/duckdb/duckdb-r
  license: MIT
  summary: The DuckDB project is an embedded analytical data management system with support for
    the Structured Query Language (SQL). This package includes all of DuckDB and a R
    Database Interface (DBI) connector.
  license_family: MIT
  license_file:
    - '{{ environ["PREFIX"] }}/lib/R/share/licenses/MIT'
    - LICENSE

# The original CRAN metadata for this package was:

# Package: duckdb
# Title: DBI Package for the DuckDB Database Management System
# Version: 0.9.1-1
# Authors@R: c(person(given = "Hannes", family = "Muhleisen", role = c("aut", "cre"), email = "hannes@cwi.nl", comment = c(ORCID = "0000-0001-8552-0029")), person(given = "Mark", family = "Raasveldt", role = "aut", email = "mark.raasveldt@cwi.nl", comment = c(ORCID = "0000-0001-5005-6844")), person("Stichting DuckDB Foundation", role = "cph"), person("Apache Software Foundation", role = "cph"), person("PostgreSQL Global Development Group", role = "cph"), person("The Regents of the University of California", role = "cph"), person("Cameron Desrochers", role = "cph"), person("Victor Zverovich", role = "cph"), person("RAD Game Tools", role = "cph"), person("Valve Software", role = "cph"), person("Rich Geldreich", role = "cph"), person("Tenacious Software LLC", role = "cph"), person("The RE2 Authors", role = "cph"), person("Google Inc.", role = "cph"), person("Facebook Inc.", role = "cph"), person("Steven G. Johnson", role = "cph"), person("Jiahao Chen", role = "cph"), person("Tony Kelman", role = "cph"), person("Jonas Fonseca", role = "cph"), person("Lukas Fittl", role = "cph"), person("Salvatore Sanfilippo", role = "cph"), person("Art.sy, Inc.", role = "cph"), person("Oran Agra", role = "cph"), person("Redis Labs, Inc.", role = "cph"), person("Melissa O'Neill", role = "cph"), person("PCG Project contributors", role = "cph"))
# Description: The DuckDB project is an embedded analytical data management system with support for the Structured Query Language (SQL). This package includes all of DuckDB and a R Database Interface (DBI) connector.
# License: MIT + file LICENSE
# URL: https://duckdb.org/, https://github.com/duckdb/duckdb-r
# BugReports: https://github.com/duckdb/duckdb-r/issues
# Depends: DBI, R (>= 3.6.0)
# Imports: methods, utils
# Suggests: arrow (>= 13.0.0), bit64, callr, DBItest, dplyr, dbplyr, rlang, testthat, tibble, vctrs, withr, adbcdrivermanager
# Encoding: UTF-8
# RoxygenNote: 7.2.3
# NeedsCompilation: yes
# Packaged: 2023-10-28 07:53:58 UTC; kirill
# Author: Hannes Muhleisen [aut, cre] (<https://orcid.org/0000-0001-8552-0029>), Mark Raasveldt [aut] (<https://orcid.org/0000-0001-5005-6844>), Stichting DuckDB Foundation [cph], Apache Software Foundation [cph], PostgreSQL Global Development Group [cph], The Regents of the University of California [cph], Cameron Desrochers [cph], Victor Zverovich [cph], RAD Game Tools [cph], Valve Software [cph], Rich Geldreich [cph], Tenacious Software LLC [cph], The RE2 Authors [cph], Google Inc. [cph], Facebook Inc. [cph], Steven G. Johnson [cph], Jiahao Chen [cph], Tony Kelman [cph], Jonas Fonseca [cph], Lukas Fittl [cph], Salvatore Sanfilippo [cph], Art.sy, Inc. [cph], Oran Agra [cph], Redis Labs, Inc. [cph], Melissa O'Neill [cph], PCG Project contributors [cph]
# Maintainer: Hannes Muhleisen <hannes@cwi.nl>
# Repository: CRAN
# Date/Publication: 2023-10-30 10:20:02 UTC

# See
# https://docs.conda.io/projects/conda-build for
# more information about meta.yaml
